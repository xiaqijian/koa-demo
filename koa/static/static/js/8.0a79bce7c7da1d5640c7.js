webpackJsonp([8],{"2Y6g":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={watch:{filterText:function(t){this.$refs.tree2.filter(t)}},mounted:function(){this.getAuditData()},methods:{filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pagesize=t},handleCurrentChange:function(t){console.log("当前页: "+t),this.currentPage=t},change1:function(t){console.log(t)},change2:function(t){console.log(t)},change3:function(t){console.log(t)},ideasuccess:function(){this.$message({message:"审核意见提交成功",type:"success"})},idealoser:function(){this.$message.error("错了哦，请认真检查哦")},selectSuccess:function(){this.$notify({title:"成功",message:"筛选成功",type:"success"})},sleectLoser:function(){this.$notify.error({title:"失败",message:"筛选失败"})},resetsuccess:function(){this.$notify({title:"成功",message:"重置成功",type:"success"})},getAuditData:function(){var t=this,e=this;e.$axios.post("tianyujia/SurveyInfoAction!queryAllSurveyInfo.action").then(function(t){console.log(t.data),e.options=t.data.data}).catch(function(t){console.log(t)});var a=JSON.parse(localStorage.getItem("user"));console.log(a);var n=a.list[0].user_org,i=a.list[0].user_orgCode;console.log(n);var o={"constructionPlan.archives.user_org":n};console.log(o),e.$axios({method:"post",url:"tianyujia/ConstructionPlanAction!queryFlowauditAllConstructionPlan.action",data:e.qs.stringify(o)}).then(function(e){var a=t;console.log(e.data.data);var n=[];e.data.data.forEach(function(t){var e=t.constructionPlanState;0==e?t.statesdata="待编制":1==e?t.statesdata="待审核":2==e?t.statesdata="已归档":3==e&&(t.statesdata="回退"),n.push(t),console.log(t)}),console.log("**********"),console.log(n),a.tableDataa=n}).catch(function(t){console.log(t)});var s={userOrg:i};e.$axios({method:"post",url:"tianyujia/ConstructionPlanAction!getLeader.action",data:e.qs.stringify(s)}).then(function(t){console.log(t.data),e.options1=t.data.data.archives}).catch(function(t){console.log(t)})},auditScreen:function(){var t=this;console.log("筛选");var e=this,a=e.auditFormInline.gname,n=e.auditFormInline.zcontent,i=e.auditFormInline.PlanStartTime,o=e.auditFormInline.PlanEndTime,s=e.auditFormInline.auditOperationSupervisor,l=e.auditFormInline.auditStatus,r=JSON.parse(localStorage.getItem("user")),c=r.list[0].user_org,u=r.list[0].user_workCode;console.log(a,n,i,o,s,l);var d={"constructionPlan.surveyInfo.surveyInfoId":a,"constructionPlan.constructionPlanContent":n,"constructionPlan.constructionPlanStartTime":i,"constructionPlan.constructionPlanEndTime":o,"constructionPlan.archivesName":s,"constructionPlan.constructionPlanState":l,"constructionPlan.archives.user_org":c,userNo:u};e.$axios({method:"post",url:"tianyujia/ConstructionPlanAction!searchConstructionPlan.action",data:e.qs.stringify(d)}).then(function(e){var a=t;console.log(1111111111),console.log(e.data.data);var n=[];e.data.data.forEach(function(t){var e=t.constructionPlanState;0==e?t.statesdata="编制":1==e?t.statesdata="待审核":2==e?t.statesdata="已归档":3==e&&(t.statesdata="回退"),n.push(t),console.log(t)}),console.log("**********"),console.log(n),a.tableDataa=n,a.selectSuccess()}).catch(function(t){console.log(t),e.sleectLoser()})},auditReset:function(){console.log("重置");this.auditFormInline.gname="",this.auditFormInline.zcontent="",this.auditFormInline.PlanStartTime="",this.auditFormInline.PlanEndTime="",this.auditFormInline.auditOperationSupervisor="",this.auditFormInline.auditStatus="",this.getAuditData(),this.resetsuccess()},auditDetails:function(t){console.log("详情");console.log(t),this.dialogVisible=!0,this.auditProjectName=t.surveyInfo.surveyInfoName,this.auditJobContent=t.constructionPlanContent,this.PlanStartTime=t.constructionPlanStartTime,this.PlanEndTime=t.constructionPlanEndTime,this.auditOperationSupervisor=t.archivesName,this.auditOperationPosition=t.constructionPlanAddr,this.auditOperationCount=t.constructionPlanNumber,this.auditStatus=t.statesdata;var e=t.constructionPlanState;console.log(e),"1"==e?(console.log(0x650e124ef1c7),this.state=!1):"0"!=e&&"2"!=e&&"3"!=e||(this.state=!0);var a=t.constructionPlanId;this.sgrwzj=a;var n=t.taskid;this.rwID=n;var i=t.archives.user_workCode;this.shrgh=i;var o=t.archives.user_deptCode;this.shrbmbm=o;var s=t.archives.user_dept;this.shrbm=s;var l=t.archives.user_orgCode;this.shdwbm=l;var r=t.archives.user_org;this.shdw=r;var c=t.archives.archives_name;this.dlrxm=c,console.log(a,n,i,o,s,l,r,c)},handleClose:function(t){t()},auditBtn:function(){console.log("审核");this.dialogVisible1=!0,this.textarea="",this.radio=""},cancelBtn:function(){console.log("关闭");this.auditOk=!1},auditBtn1:function(){var t=this;console.log("提交输入内容");var e=this,a=e.sgrwzj,n=e.rwID,i=e.radio,o=e.textarea;console.log(a,n,i,l,o,r,c,u,d,h);var s=JSON.parse(localStorage.getItem("user"));console.log(s);var l=s.list[0].user_workCode,r=s.list[0].user_deptCode,c=s.list[0].user_dept,u=s.list[0].user_orgCode,d=s.list[0].user_org,h=s.list[0].archives_name,p={"constructionPlan.constructionPlanId":a,"constructionPlan.taskid":n,"constructionPlan.constructionPlanState":i,"constructionPlanFlowaudit.archivesWorkCode":l,"constructionPlanFlowaudit.constructionPlanFlowauditContext":o,"constructionPlanFlowaudit.archivesDeptCode":r,"constructionPlanFlowaudit.archivesDept":c,"constructionPlanFlowaudit.archivesOrgCode":u,"constructionPlanFlowaudit.archivesOrg":d,"constructionPlanFlowaudit.archivesName":h};""==o||""==i?this.$message({message:"请确认是否填写完整",type:"warning"}):(e.$axios({method:"post",url:"tianyujia/ConstructionPlanFlowauditAction!flowaudit.action",data:e.qs.stringify(p)}).then(function(a){console.log(a.data.data),t.ideasuccess(),e.getAuditData()}).catch(function(e){console.log(e),t.idealoser()}),e.dialogVisible1=!1,e.dialogVisible=!1)},cancelBtn1:function(){console.log("关闭");this.auditSeen=!1}},data:function(){return{state:!0,dialogVisible:!1,dialogVisible1:!1,auditOk:!1,auditSeen:!1,currentPage:1,total:1,pagesize:6,auditProjectName:"",auditJobContent:"",auditOperationSupervisor:"",auditOperationPosition:"",auditOperationCount:"",auditStatus:"",PlanStartTime:"",PlanEndTime:"",textarea:"",radio:"",auditFormInline:{gname:"",zcontent:"",PlanStartTime:"",PlanEndTime:"",auditOperationSupervisor:"",auditStatus:""},options:[],options1:[],states:[{label:"编制",value:0},{label:"待审核",value:1},{label:"已归档",value:2},{label:"回退",value:3}],tableDataa:[],sgrwzj:"",rwID:"",shrgh:"",shrbmbm:"",shrbm:"",shdwbm:"",shdw:"",dlrxm:""}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.auditFormInline}},[a("el-form-item",{attrs:{label:"工程名称"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择工程名称"},on:{change:t.change1},model:{value:t.auditFormInline.gname,callback:function(e){t.$set(t.auditFormInline,"gname",e)},expression:"auditFormInline.gname"}},t._l(t.options,function(t){return a("el-option",{key:t.surveyInfoId,attrs:{label:t.surveyInfoName,value:t.surveyInfoId}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"作业内容"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入..."},model:{value:t.auditFormInline.zcontent,callback:function(e){t.$set(t.auditFormInline,"zcontent",e)},expression:"auditFormInline.zcontent"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd hh:mm:ss",placeholder:"计划开始时间"},model:{value:t.auditFormInline.PlanStartTime,callback:function(e){t.$set(t.auditFormInline,"PlanStartTime",e)},expression:"auditFormInline.PlanStartTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd hh:mm:ss",placeholder:"计划结束时间"},model:{value:t.auditFormInline.PlanEndTime,callback:function(e){t.$set(t.auditFormInline,"PlanEndTime",e)},expression:"auditFormInline.PlanEndTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"作业负责人"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择作业负责人"},on:{change:t.change2},model:{value:t.auditFormInline.auditOperationSupervisor,callback:function(e){t.$set(t.auditFormInline,"auditOperationSupervisor",e)},expression:"auditFormInline.auditOperationSupervisor"}},t._l(t.options1,function(t){return a("el-option",{key:t.archives_name,attrs:{label:t.archives_name,value:t.archives_name}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"计划状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"状态选择"},on:{change:t.change3},model:{value:t.auditFormInline.auditStatus,callback:function(e){t.$set(t.auditFormInline,"auditStatus",e)},expression:"auditFormInline.auditStatus"}},t._l(t.states,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.auditScreen()}}},[t._v("筛选")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.auditReset()}}},[t._v("重置")])],1)],1)],1),t._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataa.slice((t.currentPage-1)*t.pagesize,t.currentPage*t.pagesize)}},[a("el-table-column",{attrs:{prop:"surveyInfo.surveyInfoName",label:"工程名称",width:"310"}}),t._v(" "),a("el-table-column",{attrs:{prop:"archives.archives_name",label:"负责人",width:"310"}}),t._v(" "),a("el-table-column",{attrs:{prop:"statesdata",label:"审核状态",width:"310"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"info",icon:"el-icon-info",size:"small"},on:{click:function(a){t.auditDetails(e.row)}}},[t._v("详情")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pagesize,layout:"total,prev, pager, next, jumper",total:t.tableDataa.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{staticClass:"sgjhxq",attrs:{title:"施工计划详情",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("ul",{staticClass:"shenhe"},[a("li",[a("b",[t._v("工程名称：")]),t._v(" "),a("span",[t._v(t._s(t.auditProjectName))])]),t._v(" "),a("li",[a("b",[t._v("作业内容：")]),t._v(" "),a("span",[t._v(t._s(t.auditJobContent))])]),t._v(" "),a("li",[a("b",[t._v("计划开始时间：")]),t._v(" "),a("span",[t._v(t._s(t.PlanStartTime))])]),t._v(" "),a("li",[a("b",[t._v("计划结束时间：")]),t._v(" "),a("span",[t._v(t._s(t.PlanEndTime))])]),t._v(" "),a("li",[a("b",[t._v("作业负责人：")]),t._v(" "),a("span",[t._v(t._s(t.auditOperationSupervisor))])]),t._v(" "),a("li",[a("b",[t._v("作业地点：")]),t._v(" "),a("span",[t._v(t._s(t.auditOperationPosition))])]),t._v(" "),a("li",[a("b",[t._v("作业人数：")]),t._v(" "),a("span",[t._v(t._s(t.auditOperationCount))])]),t._v(" "),a("li",[a("b",[t._v("计划状态：")]),t._v(" "),a("span",[t._v(t._s(t.auditStatus))])])]),t._v(" "),a("el-button",{staticClass:"shenhebtn",attrs:{type:"primary",disabled:t.state},on:{click:function(e){t.auditBtn()}}},[t._v("审核")]),t._v(" "),a("el-button",{staticClass:"resetbtn",attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1),t._v(" "),a("el-dialog",{staticClass:"sgjhxq",attrs:{title:"审核意见",visible:t.dialogVisible1,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible1=e}}},[a("el-input",{staticClass:"audit-content",attrs:{type:"textarea",rows:4,placeholder:"待输入"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),t._v(" "),a("el-radio",{staticClass:"audit-selet",attrs:{label:"2"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("归档")]),t._v(" "),a("el-radio",{staticClass:"audit-selet",attrs:{label:"3"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("回退")]),t._v(" "),a("el-button",{staticClass:"shenhebtn",attrs:{type:"primary"},on:{click:function(e){t.auditBtn1()}}},[t._v("确定")]),t._v(" "),a("el-button",{staticClass:"resetbtn",attrs:{type:"primary"},on:{click:function(e){t.dialogVisible1=!1}}},[t._v("取消")])],1)],1)},staticRenderFns:[]};var o=a("VU/8")(n,i,!1,function(t){a("Ccls")},null,null);e.default=o.exports},"9JX0":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.pagination{\n  width: 600px;\n  margin: auto;\n}\n.shenhe{\n  list-style: none;\n}\n.app-container{\n  position: relative;\n}\n.auditIsShow{\n  position: absolute;\n  top: 50%;\n  width: 540px;\n  left: 50%;\n  height: 450px;\n  background:white;\n  border: 2px solid skyblue;\n  margin-left: -260px;\n  margin-top: -240px;\n}\n.auditIsSeen{\n  position: absolute;\n  top: 50%;\n  width: 410px;\n  left: 50%;\n  height: 340px;\n  background: white;\n  border: 2px solid skyblue;\n  margin-left: -210px;\n  margin-top: -170px;\n}\n.shenhebtn,.resetbtn{\n  margin-top: 20px;\n  margin-left: 160px;\n}\n.audit-idea{\n  text-align: center;\n}\n.audit-selet{\n  margin-left: 100px;\n  margin-top:30px;\n}\n.shenhebtn1{\n  margin-left: 70px;\n  margin-top: 60px;\n  width: 60xp;\n  width: 100px;\n}\n.resetbtn1{\n  margin-left: 70px;\n  margin-top: 60px;\n  width: 60xp;\n  width: 100px;\n}\n.el-table{\n  height: 400px;\n}\n",""])},Ccls:function(t,e,a){var n=a("9JX0");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("9716a6e0",n,!0)}});